<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2
                              http://maven.apache.org/xsd/assembly-1.1.2.xsd">
  <id>rowcache-assembly</id>

  <formats>
    <format>tar.gz</format>
  </formats>

  <includeBaseDirectory>false</includeBaseDirectory>

  <fileSets>
    <fileSet>
      <directory>${basedir}/src/main/resources/rowcache</directory>
      <outputDirectory>/</outputDirectory>
      <filtered>false</filtered>
    </fileSet>
  </fileSets>

  <!-- Put only what you actually need at runtime on an HBase server -->
  <dependencySets>
  <dependencySet>
  <outputDirectory>lib</outputDirectory>
  <scope>runtime</scope>
  <useTransitiveDependencies>true</useTransitiveDependencies>

  <excludes>
    <!-- keep your existing excludes ... -->
    <!-- ObjectCache-only deps: exclude to avoid conflicts / shrink distro -->
    <exclude>com.github.ben-manes.caffeine:caffeine</exclude>
    <exclude>com.esotericsoftware.kryo:kryo5</exclude>
    <!-- caffeine transitives -->
    <exclude>org.jspecify:jspecify</exclude>
    <exclude>com.google.errorprone:error_prone_annotations</exclude>
    <exclude>org.apache.hbase:*</exclude>
    <exclude>org.apache.hadoop:*</exclude>
    <exclude>org.apache.logging.log4j:*</exclude>
    <exclude>org.slf4j:*</exclude>
    <exclude>log4j:log4j</exclude>

    <!-- and also exclude test-only aws -->
    <exclude>com.amazonaws:*</exclude>
    <exclude>org.apache.hadoop:hadoop-aws</exclude>
  </excludes>
</dependencySet>
</dependencySets>
  <!-- Remove moduleSets to avoid double-including reactor outputs -->
</assembly>
